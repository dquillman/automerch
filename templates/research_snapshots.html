{% extends "base.html" %}
{% block content %}
<h2>Research Snapshots</h2>

<form method="get" action="/research/snapshots" style="margin-bottom:8px;">
  <input type="text" name="q" value="{{ q }}" placeholder="Filter by keywords" />
  <button type="submit">Filter</button>
  <a href="/research" style="margin-left:8px;">Run Research</a>
  <a href="/research/snapshots" style="margin-left:8px;">Clear</a>
  <span style="opacity:0.7;margin-left:8px;">Total: {{ rows|length }}</span>
  </form>

<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>When</th>
      <th>Keywords</th>
      <th>Limit</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
  {% for r in rows %}
    <tr>
      <td>{{ r.created_at }}</td>
      <td>{{ r.keywords }}</td>
      <td>{{ r.limit }}</td>
      <td>
        <details>
          <summary>View JSON</summary>
          <pre><code>{{ r.metrics_json }}</code></pre>
          <pre><code>{{ r.llm_json }}</code></pre>
        </details>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}

